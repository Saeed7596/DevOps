# **Admission Controller in Kubernetes**

**Admission Controller** is an **internal component in Kubernetes** that intercepts API requests **before they are persisted in etcd** to validate, modify, or reject them. These controllers help enforce **policies** and enhance security within the cluster.

---

### **How Admission Controllers Work**

When an API request (such as creating, updating, or deleting a resource) is made, it follows these steps:

1Ô∏è‚É£ **Authentication & Authorization** ‚Üí Verifies the user's identity and permissions.  
2Ô∏è‚É£ **Admission Controllers Execution** ‚Üí Validates or modifies the request before saving it in etcd.  
3Ô∏è‚É£ **Persistence in etcd** ‚Üí The final state is stored in etcd.  

---

### **Types of Admission Controllers**

Admission Controllers are categorized into two types:

1. **Mutating Admission Controllers** üöÄ  
   - Can **modify** requests (e.g., adding default fields).  
   - Example: **MutatingAdmissionWebhook**, which can modify Pod specs before scheduling.  

2. **Validating Admission Controllers** üîí  
   - Only **validate requests** and decide whether to accept or reject them.  
   - Example: **ValidatingAdmissionWebhook**, which enforces security policies.  

---

### **Example: Mutating Webhook to Add Labels to Pods**

```yaml
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: add-label-webhook
webhooks:
  - name: add-label.k8s.io
    clientConfig:
      service:
        name: webhook-service
        namespace: default
        path: "/mutate"
    rules:
      - operations: ["CREATE"]
        apiGroups: [""]
        apiVersions: ["v1"]
        resources: ["pods"]
    admissionReviewVersions: ["v1"]
    sideEffects: None
```
‚úÖ This webhook adds a **specific label** to Pods before they are created.  

---

### **Common Admission Controllers in Kubernetes**

| **Admission Controller**         | **Type**     | **Description** |
|----------------------------------|-------------|--------------------------------------------------|
| **MutatingAdmissionWebhook**     | Mutating    | Allows modifying Kubernetes resource specs. |
| **ValidatingAdmissionWebhook**   | Validating  | Validates and rejects requests if necessary. |
| **NamespaceLifecycle**           | Validating  | Prevents deletion of system-critical namespaces. |
| **PodSecurity** *(New)*         | Validating  | Enforces security policies for Pods (replaces PSP). |
| **ResourceQuota**                | Validating  | Enforces resource limits in namespaces. |

---

### **Summary**
‚úÖ **Admission Controllers** validate and modify API requests before persistence.  
‚úÖ Two types: **Mutating (modifying)** and **Validating (enforcing rules)**.  
‚úÖ Webhooks allow creating custom Admission Controllers.  
‚úÖ Security policies like **PodSecurity** and **ResourceQuota** rely on Admission Controllers.  

